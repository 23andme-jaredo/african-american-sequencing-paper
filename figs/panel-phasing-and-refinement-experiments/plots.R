library(ggplot2)
library(scales)
bakeoff <- read.csv('imputation-and-phasing-experiments.csv',as.is=TRUE)
bakeoff$variant <- factor(bakeoff$variant,levels=c('SNP','INDEL'))
bakeoff$phaser <- factor(bakeoff$phaser,levels=c('SHAPEIT-4.1.3',c('Eagle-2.4.1')))
bakeoff$refinement <- tolower(bakeoff$refinement)
lvls <- c("DV-0.10.0 no genotype refinement","DV-0.10.0 with genotype refinement","GATK-3.5.0 no genotype refinement","GATK-3.5.0 with genotype refinement")
bakeoff$caller2 <- with(bakeoff,factor(paste(caller,refinement),levels=lvls))

plt <- ggplot(bakeoff,aes(x=af,y=r2,lty=phaser,col=caller2))+theme_bw()
plt <- plt+geom_line()+facet_grid(rows=vars(paste(truth,'truth')),cols=vars(variant))
plt <- plt+theme(legend.title=element_blank(),legend.position='top',legend.direction='vertical')
plt <- plt+scale_y_continuous(breaks=seq(0,1,.1),name=bquote('Aggregate '~R^2))+xlab("Panel allele frequency")
plt <- plt+scale_color_manual(values=c("#E31A1C","#FB9A99","#1F78B4","#A6CEE3"))
plt <- plt+scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),labels = trans_format("log10", math_format(10^.x)))
ggsave('imputation-and-phasing-experiments.png',plot=plt,width=8,height=9)
